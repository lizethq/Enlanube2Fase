<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <report
            id="report_custom_account_cash"
            string="Recibo de caja"
            model="account.payment"
            report_type="qweb-pdf"
            name="reports_account_thomas.report_custom_template_account_cash"
        />

        <record id="paperformat_low_monthly_report_account_cash" model="report.paperformat">
            <field name="name">Formato de papel recibo de caja</field>
            <field name="default" eval="True"/>
            <field name="format">A4</field>
            <field name="page_height">0</field>
            <field name="page_width">0</field>
            <field name="orientation">Portrait</field>
            <field name="margin_top">50</field> 
            <field name="margin_bottom">30</field>
            <field name="margin_left">13</field>
            <field name="margin_right">13</field>
            <field name="header_line" eval="False"/>
            <field name="header_spacing">40</field>
            <field name="dpi">90</field>
        </record>

        <template id="report_custom_template_account_cash"> 
            <t t-call="web.html_container">
                <t t-foreach="docs" t-as="o">
                    <div class="header" style="margin: 0px -15px;">
                        <img t-att-src="'data:image/png;base64,%s' % to_text(o.company_id.logo)" width="150" height="60"/> 
						<br />
						<div style="border-bottom: 1px solid black; margin-top: 5px;"/> 
						<span t-field="o.company_id.partner_id" /> <br />
                        <t t-if="o.company_id.vat"> NIT: <span t-field="o.company_id.vat" /> <br /> </t>
						<t t-if="o.company_id.street"> <span t-field="o.company_id.street" /> <br /> </t>                        
						<t t-if="o.company_id.phone"> <span t-field="o.company_id.phone" /> </t>
                    </div> 
                    <div class="article o_report_layout_standard"> 
                        <div class="page">
                            <style>							   
								th, td{
									padding: 0px;
									font-size: 10pt;                                    
                                    border: 1px solid #000;
                                }					   							  
                                table{
                                    width: 100%;
                                    border: 1px solid #000;
                                    border-spacing: 0px;  
                                }
							    th{
								    text-align: center;
							    }
							    .container{
								    margin: 0px;
								    padding: 0px;
							    }
							    td{
								    padding: 0px 5px;
							    }
                            </style>
                            <table>
                                <tr>
	                                <th style="background-color:#CBCBCB; text-align:center; vertical-align: middle;">DATOS DEL TERCERO</th>
	                                <th colspan="2" style="background-color:#CBCBCB; text-align:center; vertical-align: middle;">RECIBO DE CAJA</th>
	                            </tr>
	                            <tr>
                                    <td valign="middle" align="left" style="padding-left: 5px;">
                                        Razón Social o Nombre: <span style="margin-left: 20px;" t-field="o.partner_id.name" /><br />
                                        NIT: <span style="margin-left: 130px;" t-field="o.partner_id.identification_document" /> <br />
                                        Dirección: <span style="margin-left: 95px;" t-field="o.partner_id.complete_adress_dian" /> <br />
                                        Ciudad: <span style="margin-left: 110px;" t-field="o.partner_id.city_id" /> <br />
                                        Télefono: <span style="margin-left: 100px;" t-field="o.partner_id.phone" />  
	                                </td>
	                                <td colspan="2" style="vertical-align: middle;">
										<p style="text-align: center; font-weight: bold; font-size: 20pt;">
											<span t-field="o.name" />
										</p>
									</td>
	                            </tr>
                                <tr>
                                    <th style="background-color:#CBCBCB">DATOS DEL PAGO</th>
                                    <th style="background-color:#CBCBCB">FECHA CONTABLE</th>                                    
                                </tr>
                                <tr>
                                    <td rowspan="3" valign="middle" align="left" style="padding-left: 5px;" width="65%">    										
										<div class="container">
											<div class="row">
												<div class="col-4">
													Concepto: <br />
													Metodo de pago: <br />
													Moneda: <br />
													Tasa de Cambio:													
												</div>
												<div class="col-8">
													<span t-field="o.payment_reference2" /> <br />
													<span t-field="o.payment_method_id" /> <br />
													<span t-field="o.currency_id" /> <br />
                                                    <span t-esc="'{0:,.2f}'.format(o.currency_rate)" />																					
												</div>
											</div>
										</div>
                                    </td>
                                    <td style="text-align: center;"><span t-field="o.payment_date" /></td> 
                                </tr>
                                <tr>
                                    <td colspan="2" style="background-color:#CBCBCB; font-weight: bold; text-align: center;" valign="middle">REFERENCIA DE FACTURA</td>
                                </tr>
                                <tr>
                                    <td colspan="2" style="text-align: center; vertical-align: middle;"><span t-field="o.communication" /></td>
                                </tr>
                            </table>
                            
                            <br />
                            
                            <table>
                                <tr>
                                    <th colspan="8" style="background-color:#CBCBCB"><center>POSICIONES DOCUMENTO CONTABLE</center></th>
                                </tr>
                                <tr>
                                    <th style="background-color:#CBCBCB"><strong><p>Cuenta</p></strong></th>
                                    <th style="background-color:#CBCBCB"><strong>Descripción</strong></th>                                 
                                    <th style="background-color:#CBCBCB"><strong>NIT</strong></th>
                                    <th style="background-color:#CBCBCB"><strong>ORD/C. ANALÍTICA</strong></th>
                                    <th style="background-color:#CBCBCB"><strong>IMP.MON.DOC</strong></th>
                                    <th style="background-color:#CBCBCB"><strong>IMP.MON.LOC</strong></th>
                                </tr>
                                <t t-foreach="o.move_line_ids" t-as="i">
                                    <tr>
                                        <td><span t-field="i.account_id.code" /></td> 
                                        <td><span t-field="i.account_id.name" /></td>
                                        <td><span t-field="i.nit" /></td>                                        
                                        <td><span t-field="i.analytic_account_id.code" /></td>                            
                                        <td t-if="i.amount_currency != 0"><span t-field="i.amount_currency" /></td>
										<td t-if="i.amount_currency == 0"><span t-field="i.balance" /></td>
                                        <td style="text-align: right;"><span t-field="i.balance" /></td>
                                    </tr>
                                </t>                                
                            </table>
                            
                            <br></br>
                            <table>
                                <tr>
                                    <th colspan="5" style="background-color:#CBCBCB"><center>RELACION DOCUMENTOS COMPENSADOS</center></th>
                                </tr>
                                <tr>                                    
                                    <th style="background-color:#CBCBCB"><strong>Descripción</strong></th>     
                                    <th style="background-color:#CBCBCB"><strong>DOC COMPEN.</strong></th>
                                    <th style="background-color:#CBCBCB"><strong>REFERENCIA</strong></th>
                                    <th style="background-color:#CBCBCB"><strong>IMP.MON.DOC</strong></th>
                                    <th style="background-color:#CBCBCB"><strong>IMP.MON.LOC</strong></th>
                                </tr>
                                <t t-foreach="o.move_line_ids" t-as="i">
                                    <t t-if="i.full_reconcile_id">
                                        <t t-set="documento" t-value="o.busqueda(i.name)" />
										<tr>
											<td><span t-field="documento.journal_id" /></td>
											<td><span t-field="documento.name" /></td>
											<td><span t-field="documento.ref" /></td>
											<td><span t-field="documento.amount_total" /></td>
											<td><span t-field="documento.amount_total_signed" /></td>											
										</tr>										
									</t>
                                </t>
                            </table> 
                        </div>  
                    </div>
					<div class="footer">
                        <style>                            
                            table{
                                width: 100%;
                                border: 1px solid #000;
                                cellpadding: 0;
                                cellspacing :0;                                    
                            }
                            #text_footer{
                                font-size: 10pt;
                            }
                        </style>
                        <div id="text_footer" style="margin: 0px -15px;">
                            <table>
                                <tr>
                                    <td align="center" style="padding-top: 40px;">
                                        <hr width="90%" color="black" style="padding: 0; margin-bottom: 0;" />
                                        Elaboro: <span style="text-align: center;" t-field="o.create_uid" />
                                    </td>
                                    <td align="center" style="padding-top: 40px;">
                                        <hr width="90%" color="black" style="padding: 0; margin-bottom: 0;" />
                                        <span style="text-align: center;">Autorizado por</span>
                                    </td>
                                    <td align="center" style="padding-top: 40px;">
                                        <hr width="90%" color="black" style="padding: 0; margin-bottom: 0;" />
                                        VoBo. Tesorería
                                    </td>                                
                                </tr>
                            </table>
                            Imprimió: <span t-field="user.name" />  <span t-esc="context_timestamp(datetime.datetime.now()).strftime('%d.%m.%Y %H:%M:%S')" />                        
                        </div>                        
                    </div>
                </t>
            </t>
        </template>
    </data>
</odoo>
